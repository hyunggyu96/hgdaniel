const { GoogleSpreadsheet } = require('google-spreadsheet');
const { JWT } = require('google-auth-library');

const SHEET_ID = '1wA1YzPatil0qnhZk1EkS4r4Roc-Mx1I-iBSlmtyJNm8';
const SERVICE_ACCOUNT_KEY_B64 = 'eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwicHJvamVjdF9pZCI6ImFlc3RoZXRpYy00ODIxMTEiLCJwcml2YXRlX2tleV9pZCI6ImU5ODVkZjBjM2I3N2VhOGQyM2IxN2Q1NmI2YTRhOTJmOWQ4NzJmNGQiLCJwcml2YXRlX2tleSI6Ii0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZRSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2N3Z2dTakFnRUFBb0lCQVFESVBYTUZFT3p4WWpDS1xuNnZvVnJqeUpmbS8vOHkrWi82SEFMbG9Jd1dXaFBsdUJNRC9pSy9sOFRlRTdoMVd6bjlsZ3Fsc2dDcFpiUmtsTFxuV2F2WUg4U2VrTWNiK081aDJSaHNyb1g1M3RmYklWcDFDVkJXbGJSdXhtZ1cyelJPZUlmWnduY2lYeHBwV1FOK1xucFM3QWlIaVNwMk56Yzk2VzcrVWdkMFUrT1BYa3lJZ1pRWXBFSGFVZS85MHcwSkxVa1RrSEt3OTdUcDlmM1NkRlxuVFRsQ3h0eUdrSFhLMGc1SWRDWUVJT1ZZNmxmWWhIY09TcXdmV1lvQ0w3YmNOOHBKZngxQ0VMRGdSQTlKQjB1TlxuZWhJNzAxUzhsdjdQNGdGWnVnUGlsc21rNVIzSEppYnpTbTFuZDJFWUMrSlpVWXgrRzNkckpkZWZnTjhmQ0ZwdFxuZHZDaVdqSDFBZ01CQUFFQ2dnRUFDZmc5Uk5CTjY4ckd2ZlByRmE5Q0pscGNPek1oZUpwb3RFZmFoYnNUVTA3bVxuZ1cwa2tSODlZYm9DNzlMU0tvcFg2Vjh5QUV0bXB3NjkwWG1hZTcxQkxkL3BlZlFQOG1FN3ZSV0hhQ1IzUE5yUlxuUlNoOGpvTVBvOEJQS0d3cms0aWV3dkhTdXF4ZmhVVkFUa3J0SS9ybmZlM0ZudGJ6Q3pMUWhxaEprMHFFdTZwRlxudHhGQkU2WHFwSmRQQVJMNUlvVjkzcmxXQkZSbmpPMWZwT2lCTUxNRUt4K2Q3QncxR1hMWmlnSnV3bVN2dTd1MFxuekRFSUV2V1JGeEhhRGRCWHpVbTZpbmNPS3hUMU1RK1d5RzMwZGlCMUxRc05uWVlmcDhEZFIybE05bDVHdk5hcVxuVHFHNG15cDhFaWNJZWpoa01uVnAwaWVYOGoxRU5SYXdaSDhMVEVtS1lRS0JnUUQwMmNnODVmM205Q3Z2ak5Bclxuby9MNEVTWHNZdFk1M1RhYk1OaVhxbUw4OHRnUU03TGJFazZVNnhPYVhObHc4Zis0SDlvVnBrdG5hS1Z2MTNhMFxuQzlBT2ZLMUsyS0ZrZVlESlFWZndyUmxER2VlVnk0V3AzOU9vNkNTd3BIWkh4Y1FRdTZEakwrcnlsNExxUlM4cFxuaXduWUtETlUrNzZxTjJnbk5aR3VXVGhpUFFLQmdRRFJXNlJJMHk0VHpQKzg5OTlIVEZlYytPZ2hBT2FPckdVU1xuRDBRUFFvc3duRW50a3pCZGhxVmZJZitBdllDSXVKWnZZcmxmb2gyV1JZVGFzcWlqa1c2ODJURFMxakxZeUxlT1xuVExQOC9hdExwemUyeksySGJBMElCNENWSk9WZnI0WEZ4ditDSlJxN0xuWm5keWZFWnlLTDZyc2M1V2k3Z2FSU1xuQ1dwcDlVYWlHUUtCZ0hNbFI4bDd6MStoVEZnblBHNkpkMlc1aXNBVDZ2TGpXUjY2WmVGTk82Z0EvQ01DYlFZaFxuSWR0ZWdhV0NMSyswM3JGVUtWY3RFU0RjVVpDN0h4T2t5bjlGbXFrc0h4b0ZHYytMYnpPNzg3bGVvVTRNbkJzN1xuSzJxdllUSEE1ZTd5empXZ1J4VVFIOGxkL3k3MHdpMGpPY254ZmRKbFlWRGpKWlBxMlV2SW9YOXhBb0dBV25tQ1xuRzc2M3NQTHNxaHRzc0lFN2M2alZtRDJ0WlliMi9zRCtKcUlaU042aHpEdkpzUUZaUWkyTkgzUEZzbEFqSXV2RlxuVFRsQ3h0eUdrSFhLMGc1SWRDWUVJT1ZZNmxmWWhIY09TcXdmV1lvQ0w3YmNOOHBKZngxQ0VMRGdSQTlKQjB1TlxuZWhJNzAxUzhsdjdQNGdGWnVnUGlsc21rNVIzSEppYnpTbTFuZDJFWUMrSlpVWXgrRzNkckpkZWZnTjhmQ0ZwdFxuZHZDaVdqSDFBZ01CQUFFQ2dnRUFDZmc5Uk5CTjY4ckd2ZlByRmE5Q0pscGNPek1oZUpwb3RFZmFoYnNUVTA3bVxuZ1cwa2tSODlZYm9DNzlMU0tvcFg2Vjh5QUV0bXB3NjkwWG1hZTcxQkxkL3BlZlFQOG1FN3ZSV0hhQ1IzUE5yUlxuUlNoOGpvTVBvOEJQS0d3cms0aWV3dkhTdXF4ZmhVVkFUa3J0SS9ybmZlM0ZudGJ6Q3pMUWhxaEprMHFFdTZwRlxudHhGQkU2WHFwSmRQQVJMNUlvVjkzcmxXQkZSbmpPMWZwT2lCTUxNRUt4K2Q3QncxR1hMWmlnSnV3bVN2dTd1MFxuekRFSUV2V1JGeEhhRGRCWHpVbTZpbmNPS3hUMU1RK1d5RzMwZGlCMUxRc05uWVlmcDhEZFIybE05bDVHdk5hcVxuVHFHNG15cDhFaWNJZWpoa01uVnAwaWVYOGoxRU5SYXdaSDhMVEVtS1lRS0JnUUQwMmNnODVmM205Q3Z2ak5Bclxuby9MNEVTWHNZdFk1M1RhYk1OaVhxbUw4OHRnUU03TGJFazZVNnhPYVhObHc4Zis0SDlvVnBrdG5hS1Z2MTNhMFxuQzlBT2ZLMUsyS0ZrZVlESlFWZndyUmxER2VlVnk0V3AzOU9vNkNTd3BIWkh4Y1FRdTZEakwrcnlsNExxUlM4cFxuaXduWUtETlUrNzZxTjJnbk5aR3VXVGhpUFFLQmdRRFJXNlJJMHk0VHpQKzg5OTlIVEZlYytPZ2hBT2FPckdVU1xuRDBRUFFvc3duRW50a3pCZGhxVmZJZitBdllDSXVKWnZZcmxmb2gyV1JZVGFzcWlqa1c2ODJURFMxakxZeUxlT1xuVExQOC9hdExwemUyeksySGJBMElCNENWSk9WZnI0WEZ4ditDSlJxN0xuWm5keWZFWnlLTDZyc2M1V2k3Z2FSU1xuQ1dwcDlVYWlHUUtCZ0hNbFI4bDd6MStoVEZnblBHNkpkMlc1aXNBVDZ2TGpXUjY2WmVGTk82Z0EvQ01DYlFZaFxuSWR0ZWdhV0NMSyswM3JGVUtWY3RFU0RjVVpDN0h4T2t5bjlGbXFrc0h4b0ZHYytMYnpPNzg3bGVvVTRNbkJzN1xuSzJxdllUSEE1ZTd5empXZ1J4VVFIOGxkL3k3MHdpMGpPY254ZmRKbFlWRGpKWlBxMlV2SW9YOXhBb0dBV25tQ1xuRzc2M3NQTHNxaHRzc0lFN2M2alZtRDJ0WlliMi9zRCtKcUlaU042aHpEdkpzUUZaUWkyTkgzUEZzbEFqSXV2RlxuTktENHJGSkt3Y0JueEpnN0JQM1BiYTRIdDB1Mmw1WnFTakROOEJuSnFBUDRFZ2dOOGFSY1d4ZmcwR01vS25wL1xuUFIwUDJraVAvdEt0cXVEdk93d3I1S2IzaGVEV3hHVXhTYTBuNHpFQ2dZRUFrbWxSbWpoVU12U3lNQkg4bllqVVxucjRYenk0eTJRRDFjczQ0K2FVYW5ES3hHVG5jSS9nUFV1TGU2RmJtbWRkOUQ0Z0hkVGRzODE5SXV5SDZQTkkyN1xuMWdUU1JVbWNSVHFHWEVUK0g5K2RkVXByQU5uaVF3dzRlOWtGNlRlVE5sbjhFNTErTDBGRUE1amRFV0FyRERYdFxuZUdqRWNwclpTYnE4NE9MWFJoNlJoeE09XG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iO

async function run() {
    const jsonStr = Buffer.from(SERVICE_ACCOUNT_KEY_B64, 'base64').toString('utf-8');
    const creds = JSON.parse(jsonStr);
    const serviceAccountAuth = new JWT({
        email: creds.client_email,
        key: creds.private_key,
        scopes: ['https://www.googleapis.com/auth/spreadsheets'],
    });
    const doc = new GoogleSpreadsheet(SHEET_ID, serviceAccountAuth);
    await doc.loadInfo();
    const sheet = doc.sheetsByTitle['LoginHistory_v2'];

    console.log('Worksheet instance keys:', Object.keys(sheet));
    console.log('insertDimension exists?', typeof sheet.insertDimension);
    console.log('insertRows exists?', typeof sheet.insertRows);
}
run();
