# 🏗️ News Dashboard System Architecture (2025-12-30)

이 문서는 현재 구축된 뉴스 대시보드 시스템의 **역할 분담**과 **데이터 흐름**을 정의합니다.
시스템은 **PC 독립적**이며, 태블릿과 클라우드 서비스만으로 24시간 자동 운영됩니다.

---

## 1. 📱 태블릿 (The Worker - 24/7 운영)

**역할**: 뉴스 수집, AI 분석, 데이터 저장
**위치**: Termux (Android)
**실행 상태**: 백그라운드 상시 가동 (`start_tablet_solo.sh`)

| 프로세스 | 기능 설명 |
| :--- | :--- |
| **Collector** (`async_collector.py`) | 30분 주기로 네이버 뉴스 API에서 최신 기사 수집 (Supabase `raw_news` 저장) |
| **AI Engine** (`Ollama`) | Llama 3.2 모델 구동 (`localhost:11434`), 인터넷 없이 로컬에서 분석 수행 |
| **Processor** (`processor.py`) | 수집된 기사를 하나씩 꺼내 AI에게 분석 지시(핵심 키워드, 요약, 중요도 평가) |
| **Data Pusher** | 분석 결과를 **Supabase**와 **Google Sheets**에 동시에 업로드 |

---

## 2. 👩‍💼 비서 (The Secretary - 정기 보고)

**역할**: 시스템 생존 신고, 업무량 모니터링, 뉴스 요약 보고
**위치**: GitHub Actions (Cloud Serverless)
**실행 주기**: 매 4시간 (`01:00`, `05:00`, `09:00`... KST)

| 업무 | 설명 |
| :--- | :--- |
| **업무량 체크** | 지난 4시간 수집/분석 건수 및 **현재 대기 중(Pending) 업무량** 파악 |
| **생존 신고** | 시스템이 정상 작동 중인지(Healthy) 아니면 과부하 상태인지 판단 |
| **뉴스 브리핑** | 주요 뉴스 제목과 키워드를 요약하여 **사용자 이메일**로 발송 |

---

## 3. ☁️ Vercel (The Presenter - 웹 대시보드)

**역할**: 사용자 인터페이스 제공, 실시간 조회
**배포 방식**: GitHub Push 시 자동 배포 (Event-based)
**데이터 갱신**: 사용자 접속 시마다 DB에서 즉시 조회 (SSR/Dynamic, `no-cache`)

| 기능 | 설명 | 저장소 |
| :--- | :--- | :--- |
| **뉴스 피드** | 태블릿이 저장한 Supabase 데이터를 실시간으로 가져와 화면에 표시 | Supabase |
| **키워드 제안** | 사용자가 입력한 키워드를 **구글 시트(키워드제안)**에 저장 (파일 인증 방식) | Google Sheet |
| **방문자 집계** | 접속자의 IP를 분석하여 일일 방문자 수를 **구글 시트(Visits)**에 저장 | Google Sheet |
| **로그인 로그** | 사용자 로그인 기록을 **구글 시트(개인별 시트)**에 저장 | Google Sheet |

---

## 4. 💾 데이터 저장소 (The Memory)

모든 데이터는 클라우드에 안전하게 저장되며, 태블릿이나 PC가 고장 나도 데이터는 유지됩니다.

* **Supabase (DB)**: 웹사이트용 고속, 구조화 데이터. (Table: `articles`, `raw_news`)
* **Google Sheets**: 관리자(사용자)용 엑셀 데이터. (Market Analysis 시트)
  * *동기화 상태: 태블릿이 두 곳에 쌍둥이 데이터를 동시에 쏘아 올림.*

---

## 5. 💻 PC (The Architect - 개발 도구)

**역할**: 코드 수정, 기능 추가, 배포 지시
**상태**: **꺼둬도 됨.** (시스템 운영에 관여하지 않음)

* PC에서 코드를 고치고 `git push`를 하면, Vercel이 웹사이트 디자인을 바꿉니다.
* PC가 꺼져 있어도 태블릿과 Vercel은 멈추지 않습니다.
